<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bitage - Chat Application (Demo)</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg: #0f1115;
      --panel: #161922;
      --panel-2: #1c2030;
      --text: #e6e9ef;
      --muted: #a7b0c0;
      --primary: #7aa2f7;
      --primary-2: #5c7db8;
      --success: #7ee787;
      --danger: #f7768e;
      --warning: #e0af68;
      --border: #262a36;
      --accent: #9ece6a;
    }
    body { font-family: system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif; height: 100vh; color: var(--text); background: var(--bg); overflow: hidden; }
    .app { display: grid; grid-template-columns: 260px 1fr; height: 100vh; }
    .sidebar { background: var(--panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
    .sidebar .brand { padding: 16px; font-weight: 700; font-size: 18px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 8px; }
    .sidebar .brand .dot { width: 10px; height: 10px; border-radius: 50%; background: var(--primary); box-shadow: 0 0 12px var(--primary); }
    .sidebar .nav { padding: 8px; overflow-y: auto; }
    .nav .group { margin-top: 12px; }
    .group .title { font-size: 12px; color: var(--muted); letter-spacing: .08em; padding: 10px 10px 6px; text-transform: uppercase; }
    .nav button { width: 100%; text-align: left; padding: 10px 12px; background: transparent; color: var(--text); border: 0; border-radius: 8px; display: flex; align-items: center; gap: 10px; cursor: pointer; }
    .nav button:hover { background: var(--panel-2); }
    .nav button.active { background: #21314f; color: #dbe7ff; outline: 1px solid #2e4c86; }
    .nav .pill { padding: 2px 8px; border-radius: 999px; font-size: 12px; background: #1f2937; color: var(--muted); margin-left: auto; }

    .topbar { height: 54px; background: var(--panel); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; }
    .topbar .section-title { display: flex; align-items: center; gap: 10px; font-weight: 600; }
    .topbar .actions { display: flex; gap: 8px; }
    .btn { background: var(--panel-2); color: var(--text); border: 1px solid var(--border); border-radius: 8px; padding: 8px 10px; cursor: pointer; }
    .btn.primary { background: #2a3d66; border-color: #2e4c86; color: #e8f0ff; }
    .btn.ghost { background: transparent; }

    .content { display: grid; grid-template-rows: 54px 1fr; height: 100vh; }
    .panel { height: calc(100vh - 54px); display: none; }
    .panel.active { display: grid; grid-template-columns: 320px 1fr; }

    .list { border-right: 1px solid var(--border); background: var(--panel); display: grid; grid-template-rows: auto 1fr auto; }
    .list .search { padding: 10px; }
    .input { width: 100%; background: var(--panel-2); border: 1px solid var(--border); color: var(--text); padding: 10px 12px; border-radius: 8px; }
    .items { overflow-y: auto; }
    .item { display: grid; grid-template-columns: 40px 1fr auto; gap: 10px; padding: 10px 12px; border-bottom: 1px solid var(--border); cursor: pointer; }
    .item:hover { background: rgba(255,255,255,0.03); }
    .avatar { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg,#4f67a3,#7aa2f7); display: grid; place-items: center; font-weight: 700; }
    .meta { display: grid; gap: 2px; }
    .meta .name { font-weight: 600; }
    .meta .sub { color: var(--muted); font-size: 13px; }

    .chat { background: linear-gradient(180deg, #0f1115 0%, #0f1115 60%, #101521 100%); display: grid; grid-template-rows: 1fr auto; }
    .messages { padding: 16px; overflow-y: auto; display: grid; gap: 12px; }
    .bubble { max-width: 70%; padding: 10px 12px; border-radius: 12px; border: 1px solid var(--border); background: var(--panel-2); }
    .me { justify-self: end; background: #203355; border-color: #2e4c86; }
    .sys { justify-self: center; background: transparent; border: 0; color: var(--muted); font-size: 12px; }
    .composer { display: grid; grid-template-columns: 1fr auto; gap: 8px; padding: 10px; border-top: 1px solid var(--border); background: var(--panel); }

    .friends-actions { display: flex; gap: 8px; padding: 10px; border-bottom: 1px solid var(--border); background: var(--panel); }
    .friend-requests { padding: 10px; border-bottom: 1px solid var(--border); }
    .row { display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; border-bottom: 1px solid var(--border); }

    .group-header { padding: 10px; border-bottom: 1px solid var(--border); background: var(--panel); display: flex; gap: 8px; }

    form.settings { display: grid; gap: 12px; padding: 16px; max-width: 640px; }
    .field { display: grid; gap: 6px; }
    .field label { color: var(--muted); font-size: 14px; }
    .field input, .field select, .field textarea { background: var(--panel-2); border: 1px solid var(--border); color: var(--text); padding: 10px 12px; border-radius: 8px; }

    .admin-grid { padding: 16px; display: grid; grid-template-columns: repeat(2,minmax(280px,1fr)); gap: 12px; }
    .card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 12px; }
    .card h4 { margin-bottom: 8px; }

    @media (max-width: 900px) {
      .app { grid-template-columns: 1fr; }
      .panel.active { grid-template-columns: 1fr; }
      .list { display: none; }
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand"><span class="dot"></span> Bitage Demo</div>
      <div class="nav">
        <div class="group">
          <div class="title">Navigate</div>
          <button data-target="dms" class="active">üí¨ Direct Messages</button>
          <button data-target="friends">üë• Friends</button>
          <button data-target="groups">üë™ Groups</button>
          <button data-target="profile">üë§ Profile</button>
          <button data-target="admin">üõ†Ô∏è Admin Panel</button>
        </div>
      </div>
    </aside>

    <section class="content">
      <div class="topbar">
        <div class="section-title"><span id="sectionIcon">üí¨</span><span id="sectionTitle">Direct Messages</span></div>
        <div class="actions">
          <button class="btn ghost" id="newChatBtn">New Chat</button>
          <button class="btn primary" id="demoSeedBtn">Seed Demo</button>
        </div>
      </div>

      <div id="panel-dms" class="panel active">
        <div class="list">
          <div class="search"><input id="dmSearch" class="input" placeholder="Search conversations" /></div>
          <div id="dmList" class="items"></div>
          <div class="row"><button class="btn" id="startDM">+ Start DM</button></div>
        </div>
        <div class="chat">
          <div id="dmMessages" class="messages"></div>
          <div class="composer">
            <input id="dmInput" class="input" placeholder="Type a message..." />
            <button id="dmSend" class="btn primary">Send</button>
          </div>
        </div>
      </div>

      <div id="panel-friends" class="panel">
        <div class="list">
          <div class="friends-actions">
            <input id="friendName" class="input" placeholder="Add friend by username" />
            <button id="addFriendBtn" class="btn primary">Add</button>
          </div>
          <div class="friend-requests" id="friendRequests"></div>
          <div class="items" id="friendsList"></div>
        </div>
        <div class="chat">
          <div class="messages" id="friendActivity"></div>
          <div class="composer">
            <input class="input" id="friendNote" placeholder="Write a note about your friend..." />
            <button class="btn" id="saveNote">Save Note</button>
          </div>
        </div>
      </div>

      <div id="panel-groups" class="panel">
        <div class="list">
          <div class="group-header">
            <input id="groupName" class="input" placeholder="Create group name" />
            <button id="createGroup" class="btn primary">Create</button>
          </div>
          <div class="items" id="groupList"></div>
        </div>
        <div class="chat">
          <div class="messages" id="groupMessages"></div>
          <div class="composer">
            <input id="groupInput" class="input" placeholder="Message group..." />
            <button id="groupSend" class="btn primary">Send</button>
          </div>
        </div>
      </div>

      <div id="panel-profile" class="panel">
        <div class="list">
          <div class="items">
            <div class="row"><strong>Account</strong></div>
            <div class="row">Username: <span id="meUsername">demo_user</span></div>
            <div class="row">Status: <span id="meStatus">Online</span></div>
          </div>
        </div>
        <div>
          <form class="settings" id="settingsForm">
            <h3>Profile Settings</h3>
            <div class="field">
              <label>Display Name</label>
              <input id="displayName" placeholder="Your display name" />
            </div>
            <div class="field">
              <label>Status</label>
              <select id="status">
                <option>Online</option>
                <option>Busy</option>
                <option>Away</option>
                <option>Offline</option>
              </select>
            </div>
            <div class="field">
              <label>About</label>
              <textarea id="about" rows="4" placeholder="Tell others about you"></textarea>
            </div>
            <div class="field">
              <label>Theme</label>
              <select id="theme">
                <option value="dark">Dark</option>
                <option value="light">Light</option>
              </select>
            </div>
            <div>
              <button type="submit" class="btn primary">Save Settings</button>
            </div>
          </form>
        </div>
      </div>

      <div id="panel-admin" class="panel">
        <div class="admin-grid">
          <div class="card">
            <h4>User Management</h4>
            <button class="btn" id="adminListUsers">List Users</button>
            <button class="btn" id="adminBanUser">Ban Random User</button>
            <div id="adminUsers" style="margin-top:8px; color: var(--muted);"></div>
          </div>
          <div class="card">
            <h4>System</h4>
            <button class="btn" id="adminStats">Show Stats</button>
            <button class="btn" id="adminClear">Clear Data</button>
            <div id="adminStatsOut" style="margin-top:8px; color: var(--muted);"></div>
          </div>
        </div>
      </div>

    </section>
  </div>

  <script>
    const store = {
      get k() { return 'bitage-demo-v1'; },
      load() { return JSON.parse(localStorage.getItem(this.k) || '{}'); },
      save(data) { localStorage.setItem(this.k, JSON.stringify(data)); },
      init() {
        const data = this.load();
        if (!data.users) data.users = [{ id:'me', name:'Demo User', username:'demo_user', status:'Online'}];
        if (!data.dms) data.dms = [
          { id:'u1', name:'Alice', last:'Hey there!', messages:[
            {from:'Alice', text:'Hey there!' },
            {from:'me', text:'Hi Alice! Welcome to Bitage demo.'},
          ]},
          { id:'u2', name:'Bob', last:'See you', messages:[
            {from:'Bob', text:'Lunch tomorrow?'},
            {from:'me', text:'Sounds good!'},
            {from:'Bob', text:'See you'},
          ]}
        ];
        if (!data.friends) data.friends = [{username:'alice'},{username:'bob'}];
        if (!data.requests) data.requests = [{username:'charlie'},{username:'diana'}];
        if (!data.groups) data.groups = [
          { id:'g1', name:'General', messages:[{from:'System', text:'Welcome to General!'}]},
          { id:'g2', name:'Developers', messages:[{from:'System', text:'Discuss code here.'}]}
        ];
        if (!data.notes) data.notes = {};
        if (!data.profile) data.profile = { displayName:'Demo User', status:'Online', about:'', theme:'dark' };
        this.save(data);
        return data;
      }
    };

    let state = store.init();

    function el(tag, cls, text){ const e=document.createElement(tag); if(cls) e.className=cls; if(text) e.textContent=text; return e; }
    function setActivePanel(key){
      document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
      document.getElementById('panel-'+key).classList.add('active');
      document.querySelectorAll('.
